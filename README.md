# 儿童识字小报生成器

一个基于 HTML/CSS/JavaScript 的 Web 应用，使用 AI 技术为 5-9 岁儿童生成双语（英文+汉字）识字小报。

## 功能特点

### ✨ 核心功能

- **双 API 配置**
  - NanoBanana API：图片生成
  - 文本生成 API：词汇生成和翻译（支持 OpenAI 兼容格式）
  - API Key 临时存储（关闭页面自动清除）
  - 连接测试功能

- **双模式场景选择**
  - 预设场景：超市、医院、公园、动物园、学校
  - 自定义场景：用户输入，AI 自动生成词汇

- **双语词汇系统**
  - 预设场景：本地词库，预配置双语词汇
  - 自定义场景：AI 自动生成双语词汇（英文+汉字）
  - 用户可以添加词汇：输入汉字，AI 自动翻译英文

- **词汇编辑**
  - 删除不需要的词汇
  - 添加新词汇（AI 自动翻译）
  - 实时预览

- **智能提示词构建**
  - 基于专业模板自动生成
  - 符合儿童认知特点

- **图片生成与下载**
  - 竖版 A4 比例（9:16）
  - 4K 高清分辨率
  - 一键下载

## 快速开始

### 1. 打开应用

直接在浏览器中打开 `index.html` 文件。

### 2. 配置 API

#### 需要准备的 API

**NanoBanana API**（必需）
- 用途：生成识字小报图片
- 接口地址：已内置，无需填写
- 需要：API Key（从 https://yunwu.apifox.cn 获取）

**文本生成 API**（必需）
- 用途：生成词汇、翻译词汇
- 支持：OpenAI 兼容格式的 API
- 需要：
  - 接口地址（如：`https://api.openai.com/v1/chat/completions`）
  - API Key
  - 模型名称（如：`gpt-4`、`qwen-turbo`）

#### 配置步骤

1. 在配置页面填写两个 API 的信息
2. 点击"测试连接"按钮验证配置
3. 看到两个绿色对号后，点击"开始使用"

### 3. 生成识字小报

#### 步骤流程

```
1. 选择场景
   ├─ 点击预设场景按钮（超市/医院/公园/动物园/学校）
   └─ 或输入自定义场景名称

2. 输入标题
   └─ 如：《我的超市之旅》

3. 生成词汇
   └─ 点击"生成词汇预览"按钮

4. 编辑词汇（可选）
   ├─ 删除不喜欢的词汇
   └─ 添加新词汇（只需输入汉字，AI 自动翻译）

5. 生成图片
   └─ 点击"生成图片"按钮，等待 30-60 秒

6. 下载图片
   └─ 点击"下载图片"保存到本地
```

## 项目结构

```
children-storybook/
├── index.html              # 主页面
├── css/
│   └── style.css          # 样式文件
├── js/
│   ├── app.js             # 主应用逻辑
│   ├── api.js             # API 调用封装
│   ├── vocabulary.js      # 词汇数据和管理
│   └── prompt.js          # 提示词构建
├── ai-docs/               # 参考文档
│   ├── prompt.md          # 提示词模板
│   └── api-nano-bana-pro.md
└── README.md              # 本文件
```

## API 调用说明

### 调用次数统计

| 场景类型 | 文本 API（词汇生成）| 文本 API（翻译） | NanoBanana API（生图）| 总计 |
|---------|-------------------|-----------------|---------------------|------|
| 预设场景，无添加词汇 | 0 次 | 0 次 | 1 次 | **1 次** |
| 预设场景，添加 3 个词汇 | 0 次 | 3 次 | 1 次 | **4 次** |
| 自定义场景，无添加词汇 | 1 次 | 0 次 | 1 次 | **2 次** |
| 自定义场景，添加 3 个词汇 | 1 次 | 3 次 | 1 次 | **5 次** |

### 费用优化建议

- 优先使用预设场景（5 个已配置好的场景），可以减少文本 API 调用
- 尽量在生成词汇后直接使用，减少手动添加词汇的次数

## 技术架构

### 前端技术

- **纯前端实现**：HTML + CSS + JavaScript（无需后端服务器）
- **数据存储**：sessionStorage（临时存储，关闭页面自动清除）
- **API 调用**：直接从浏览器调用（需要 API 支持 CORS）

### API 集成

- **文本生成 API**：OpenAI 兼容格式（用户自定义）
- **NanoBanana API**：固定地址（代码内置）

## 安全说明

### API Key 管理

- ✅ API Key 存储在 `sessionStorage`
- ✅ 关闭浏览器标签页后自动清除
- ✅ 不会永久保存到本地
- ⚠️ 不要在公共电脑上保存 API Key
- ⚠️ 不要与他人分享你的 API Key

### CORS 问题

如果遇到跨域错误（CORS），可能的原因：

1. **API 不支持跨域请求**
   - 解决方案：联系 API 提供商开启 CORS
   - 临时方案：使用浏览器扩展（如 CORS Unblock）

2. **需要后端代理**
   - 如果 API 不支持 CORS，需要搭建简单的 Node.js 代理服务器

## 常见问题

### Q1: 为什么需要两个 API？

A: 两个 API 分工不同：
- **文本 API**：生成词汇、翻译词汇（轻量级任务）
- **NanoBanana API**：生成高质量图片（重量级任务）

### Q2: 支持哪些文本 API？

A: 支持所有 OpenAI 兼容格式的 API，包括：
- OpenAI ChatGPT API
- 国内的通义千问、讯飞星火、智谱 AI 等（如果提供 OpenAI 兼容接口）
- 其他第三方 OpenAI 兼容 API

### Q3: 生成的图片是什么格式？

A: 生成的图片是 JPG 格式，竖版 A4 比例（9:16），4K 分辨率。

### Q4: 为什么生成图片需要这么久？

A: AI 图片生成通常需要 30-60 秒，这是正常现象。请耐心等待。

### Q5: 可以保存自定义场景的词汇吗？

A: 当前版本不支持保存自定义场景词汇。如果需要经常使用某个场景，建议联系开发者添加到预设场景中。

### Q6: API Key 安全吗？

A: API Key 仅存储在浏览器的 sessionStorage 中，关闭页面后自动清除。但仍建议：
- 不要在公共电脑上使用
- 定期更换 API Key
- 不要与他人分享

## 开发说明

### 本地运行

1. 克隆或下载项目
2. 直接用浏览器打开 `index.html`
3. 无需安装任何依赖

### 自定义预设场景

编辑 `js/vocabulary.js` 文件，在 `PRESET_VOCABULARY` 对象中添加新场景：

```javascript
"新场景": {
    "核心": [
        "english 汉字",
        "english 汉字",
        ...
    ],
    "物品": [
        "english 汉字",
        ...
    ],
    "环境": [
        "english 汉字",
        ...
    ]
}
```

### 自定义提示词模板

编辑 `js/prompt.js` 文件中的 `PromptBuilder.build()` 方法。

## 许可证

本项目仅供学习和个人使用。

## 支持与反馈

如遇到问题或有建议，请通过以下方式联系：

- 提交 Issue
- 发送邮件

---

**享受创作双语识字小报的乐趣吧！** 🎨📚
